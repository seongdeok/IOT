from time import sleep
import broadlink
ON = b"&\x00P\x00\x00\x01'\x94\x147\x137\x147\x13\x13\x13\x13\x12\x13\x13\x13\x137\x13\x13\x13\x13\x127\x147\x137\x146\x147\x13\x13\x137\x13\x13\x137\x13\x13\x13\x13\x137\x13\x13\x13\x13\x12\x13\x137\x14\x12\x137\x146\x14\x13\x136\x146\x13\x00\x04\xd6\x00\x01'I\x14\x00\r\x05\x00\x00\x00\x00\x00\x00\x00\x00"
OFF = b"&\x00P\x00\x00\x01'\x94\x146\x147\x137\x14\x12\x13\x13\x13\x12\x14\x12\x137\x14\x12\x13\x13\x137\x137\x147\x137\x146\x14\x13\x13\x13\x12\x13\x13\x13\x136\x14\x12\x14\x12\x137\x147\x137\x137\x147\x13\x13\x137\x137\x13\x13\x13\x11\x14\x00\x04\xd5\x00\x01'J\x13\x00\r\x05\x00\x00\x00\x00\x00\x00\x00\x00"
MUTE = b"&\x00X\x00\x00\x01'\x94\x147\x137\x146\x14\x12\x13\x13\x13\x12\x14\x12\x137\x14\x13\x13\x12\x137\x147\x137\x137\x147\x13\x12\x14\x12\x13\x13\x137\x13\x13\x137\x14\x12\x13\x12\x147\x137\x147\x13\x12\x147\x13\x12\x147\x137\x13\x12\x13\x00\x04\xd5\x00\x01(I\x14\x00\x0cV\x00\x01'J\x13\x00\r\x05"
VOL_UP = b"&\x00X\x00\x00\x01(\x94\x137\x146\x147\x13\x13\x13\x13\x13\x13\x12\x13\x137\x14\x12\x13\x13\x137\x137\x146\x147\x137\x14\x13\x12\x13\x13\x13\x13\x13\x127\x14\x13\x13\x12\x13\x13\x137\x137\x146\x147\x13\x13\x137\x137\x146\x14\x12\x13\x00\x04\xd5\x00\x01'J\x13\x00\x0cV\x00\x01'J\x13\x00\r\x05"
VOL_DOWN = b"&\x00X\x00\x00\x01'\x94\x147\x137\x147\x13\x13\x13\x13\x13\x12\x13\x13\x137\x13\x13\x13\x13\x136\x147\x137\x146\x147\x13\x13\x13\x13\x13\x13\x127\x147\x13\x13\x13\x13\x13\x12\x137\x146\x147\x13\x13\x13\x13\x136\x147\x137\x14\x12\x12\x00\x04\xd6\x00\x01'I\x14\x00\x0cV\x00\x01'I\x14\x00\r\x05"
DISC = b"&\x00X\x00\x00\x01'\x95\x137\x137\x147\x13\x12\x14\x12\x13\x13\x13\x12\x147\x13\x12\x14\x12\x137\x147\x137\x146\x147\x13\x13\x137\x13\x13\x13\x12\x147\x13\x12\x14\x12\x13\x13\x137\x13\x13\x137\x147\x13\x12\x147\x137\x137\x14\x11\x13\x00\x04\xd6\x00\x01'J\x13\x00\x0cV\x00\x01'I\x14\x00\r\x05"
CD = b"&\x00P\x00\x00\x01'\x94\x146\x147\x137\x14\x12\x13\x13\x13\x12\x14\x12\x137\x14\x12\x13\x13\x137\x137\x147\x137\x137\x14\x12\x146\x14\x12\x147\x13\x12\x14\x12\x13\x13\x13\x12\x146\x14\x12\x147\x13\x12\x147\x137\x137\x147\x13\x11\x14\x00\x04\xd5\x00\x01'J\x13\x00\r\x05\x00\x00\x00\x00\x00\x00\x00\x00"
VIDEO = b"&\x00X\x00\x00\x01'\x94\x137\x147\x137\x13\x13\x13\x13\x13\x12\x13\x13\x137\x13\x13\x13\x12\x147\x137\x146\x147\x137\x14\x12\x13\x13\x137\x13\x13\x13\x12\x14\x12\x13\x13\x137\x137\x147\x13\x13\x137\x137\x147\x137\x13\x13\x13\x11\x14\x00\x04\xd5\x00\x01'J\x13\x00\x0cV\x00\x01'J\x13\x00\r\x05"
AUX = b"&\x00X\x00\x00\x01'\x94\x147\x137\x137\x14\x12\x13\x13\x13\x12\x14\x13\x127\x14\x13\x12\x13\x137\x137\x147\x137\x146\x14\x12\x147\x137\x13\x13\x137\x137\x14\x12\x14\x12\x137\x14\x13\x12\x13\x137\x13\x12\x14\x13\x136\x147\x13\x12\x13\x00\x04\xd5\x00\x01(I\x14\x00\x0cU\x00\x01(I\x14\x00\r\x05"
TUNNER = b"&\x00P\x00\x00\x01'\x94\x147\x137\x137\x14\x13\x12\x13\x13\x12\x14\x13\x127\x14\x12\x14\x13\x127\x147\x137\x137\x147\x13\x12\x147\x13\x13\x137\x137\x146\x14\x12\x146\x147\x13\x13\x137\x13\x13\x13\x12\x14\x13\x127\x14\x12\x13\x12\x13\x00\x04\xd7\x00\x01'J\x13\x00\r\x05\x00\x00\x00\x00\x00\x00\x00\x00"
TAPE = b"&\x00X\x00\x00\x01'\x94\x147\x137\x146\x14\x12\x14\x13\x12\x13\x13\x12\x146\x14\x13\x13\x12\x137\x147\x137\x137\x147\x13\x13\x137\x13\x13\x137\x137\x14\x12\x13\x13\x13\x12\x147\x13\x12\x147\x13\x12\x14\x12\x137\x147\x137\x13\x12\x13\x00\x04\xd6\x00\x01'J\x13\x00\x0cV\x00\x01'J\x13\x00\r\x05"
# initially setup. 
# put the devie into ap mode
# Long press the reset button until the blue LED is blinking quickly.
# Long press again until blue LED is blinking slowly.
# and then connect WIFI BROADLINK AP before setup()
def setup():
    broadlink.setup('AP', 'PASSWD',3)

def learning():
    key_list = [ 'On', 'Off', 'MUTE', 'Volume Up', 'Volume Down','DISC','CD','VIDEO', 'AUX', 'TUNNER', 'TAPE']
    for key in key_list:
        device.enter_learning()
        print(f"Press {key} Remote Controll Button and press Enter")
        while True:
            try:
                packet = device.check_data()  # Wait for the data to be learned
            except Exception as e:
                packet = None
            if packet :
                print(f"{key} = {packet}")
                break
            else :
                sleep(1)
    

device = broadlink.hello('192.168.219.115')
device.auth()

#device.send_data(v1)
#device.send_data(power)
while True: 
    device.send_data(ON)    
    sleep(10)
    device.send_data(OFF)